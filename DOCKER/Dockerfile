# The source image to start with
FROM alpine:3.20.3

# Your contact info
MAINTAINER wiggal ;ludwig.sporrer@gmx.de

# Setzen der Umgebungsvariablen f체r die deutsche Sprache
ENV CONTAINER_TIMEZONE="Europe/Berlin" \
    LANG=de_DE.UTF-8 \
    LANGUAGE=de_DE:de \
    LC_ALL=de_DE.UTF-8

RUN apk add --update-cache git
#git clon_Ladesteuerung-main/ nach /home/GEN24
RUN git clone -b main https://github.com/wiggal/GEN24_Ladesteuerung.git /home/GEN24

RUN apk add --update-cache \
    php \
    php-json \
    php-sqlite3 \
    php-cli \
    php-posix \
    php-curl \
    tzdata \
    python3 \
    py-pip \
    bash \
    file \
    py3-aiohttp \
    py3-websockets \
    py3-requests \
  && rm -rf /var/cache/apk/* \
&& cp /usr/share/zoneinfo/Europe/Berlin /etc/localtime \
&& sed -i 's/^Einfacher_PHP_Webserver.*/Einfacher_PHP_Webserver = 1/' /home/GEN24/CONFIG/default.ini \
&& echo "# DO NOT EDIT THIS FILE - edit the master and reinstall." >>/var/tmp/www-data \
&& echo "#1-56/10 * * * * /home/GEN24/start_PythonScript.sh EnergyController.py schreiben" >>/var/tmp/www-data \
&& echo "#33 5,8,10,12,14,19 * * * /home/GEN24/start_PythonScript.sh WeatherDataProvider2.py" >>/var/tmp/www-data \
&& echo "### /home/GEN24/Crontab.log abr채umen" >>/var/tmp/www-data \
&& echo "#0 0 * * 1 mv /home/GEN24/Crontab.log /home/GEN24/Crontab.log_weg" >>/var/tmp/www-data \
&& chmod +x /home/GEN24/start_* \
&& >> /home/GEN24/Crontab.log \
&& touch /var/log/cron.log

# Alle Befehle die Nach dem Imagestart ausgef체hrt werden m체ssen
CMD ["sh", "/home/GEN24/DOCKER/docker-entrypoint.sh"]
